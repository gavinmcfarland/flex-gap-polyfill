{"version":3,"file":"index.mjs","sources":["src/index.js"],"sourcesContent":["import postcss from \"postcss\";\nconst { parse } = require('postcss-values-parser');\n\nmodule.exports = (opts = {}) => {\n\topts = opts || {}\n\n\tconst pf = \"--fgp-\";\n\tconst flexGapNotSupported = opts.flexGapNotSupported ? opts.flexGapNotSupported + \" \" : \"\";\n\n\t// TODO: Seperate original styles and polyfill styles using selector :not(.supportsFlexGap)\n\n\tfunction hasFlex(decl, obj) {\n\n\t\tif (decl.prop === \"display\") {\n\t\t\tconst origContainer = decl.parent;\n\n\t\t\tconst container = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector}` });\n\t\t\tconst item = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector} > *` });\n\n\t\t\tif (decl.value === \"flex\" || decl.value === \"inline-flex\") {\n\t\t\t\torigContainer.after(container);\n\n\t\t\t\tcontainer.before(item);\n\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}has-polyfil_gap-container: initial;`\n\t\t\t\t);\n\t\t\t\titem.append(\n\t\t\t\t\t`${pf}has-polyfil_gap-item: initial;`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\titem.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\t}\n\n\t\tif (decl.prop === \"display\" && decl.value === \"flex\") {\n\t\t\tobj.hasFlex = true;\n\t\t}\n\n\t\tif (decl.prop === \"display\" && decl.value === \"inline-flex\") {\n\t\t\tobj.hasFlex = true;\n\t\t}\n\n\t}\n\n\n\tfunction addGap(rule, values, marginValues, opts) {\n\n\t\tconst origContainer = rule;\n\n\t\tconst container = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector}` });\n\t\tconst item = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector} > *` });\n\t\tconst reset = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector} > * > *` });\n\t\tconst slotted = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector} > ::slotted(*)` });\n\n\t\torigContainer.after(container);\n\n\t\tcontainer.before(item);\n\t\titem.before(reset);\n\n\t\t// Just a precaution incase flex gap detection has false positive\n\t\tif (opts.flexGapNotSupported) {\n\t\t\tcontainer.append(\n\t\t\t\t`gap: 0;`\n\t\t\t)\n\t\t}\n\n\t\tconst properties = [\n\t\t\t[\"_row\", \"top\"],\n\t\t\t[\"_column\", \"left\"]\n\t\t];\n\n\t\tproperties.forEach((property, index) => {\n\n\t\t\tvar axis = property[0];\n\t\t\tvar side = property[1];\n\n\t\t\tvar value = values[index];\n\n\t\t\tif (value === \"0\") {\n\t\t\t\tvalue = \"0px\";\n\t\t\t}\n\t\t\tvar number = parse(value).nodes[0].value\n\t\t\tvar unit = parse(value).nodes[0].unit;\n\n\t\t\tvar percentageRowGaps = opts.percentageRowGaps || unit != \"%\" && axis === \"_row\";\n\n\t\t\t// Percentages\n\t\t\tif (unit === \"%\") {\n\t\t\t\t// formula: (parent - self) / (100 - self) * 100\n\t\t\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t`${pf}gap_percentage-decimal${axis}: ${number / 100};\n\t\t\t\t${pf}gap_container${axis}: var(${pf}has-polyfil_gap-container, var(${pf}gap_percentage-to-pixels${axis}, calc( ((var(${pf}gap_parent${axis}, 0%) - ${value}) * var(${pf}width_percentages-decimal, 1)) / (100 - ${number}) * 100))) !important;`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t`${pf}gap_container${axis}: var(--fgp-gap_item_row) !important;`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Pixels, Ems\n\t\t\telse {\n\t\t\t\t// formula: (parent - self)\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}gap_container${axis}: var(${pf}has-polyfil_gap-container, calc(var(${pf}gap_parent${axis}, 0px) - ${value})) !important;`\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\treset.append(\n\t\t\t\t`${pf}gap_item${axis}: initial;`\n\t\t\t);\n\n\t\t\titem.append(\n\t\t\t\t`pointer-events: all;\n\t\t\t${pf}gap_container${axis}: initial;\n\t\t\t${pf}gap_item${axis}: var(${pf}has-polyfil_gap-item, ${value}) !important;\n\t\t\t${pf}gap${axis}: var(${pf}gap_item${axis});`\n\t\t\t);\n\n\n\t\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t\titem.append(\n\t\t\t\t\t`${pf}gap_parent${axis}: var(${pf}has-polyfil_gap-item, ${value}) !important;\n\t\t\t\t\tmargin-${side}: var(${pf}gap${axis});`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tcontainer.append(\n\t\t\t\t`pointer-events: none;\n\t\t\t${pf}gap_parent${axis}: initial;\n\t\t\t${pf}gap_item${axis}: initial;\n\t\t\t${pf}gap${axis}: var(${pf}gap_container${axis}) !important;\n\t\t\tpadding-top: 0.02px;`\n\t\t\t);\n\n\n\n\t\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t\t// Moved !important to from margin property to custom property. Not sure if this breaks anything\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}margin-${side}: calc(var(${pf}gap${axis}) + ${marginValues[0]}) !important;\n\t\t\t\t\tmargin-${side}: var(${pf}margin-${side});`\n\t\t\t\t);\n\t\t\t}\n\n\n\t\t\t// If web components\n\t\t\tif (opts.webComponents === true) {\n\t\t\t\tcontainer.before(slotted);\n\n\t\t\t\tslotted.append(\n\t\t\t\t\t`${pf}gap_parent${axis}: ${value};\n\t\t\t\t${pf}gap_item${axis}: ${value};\n\t\t\t\t${pf}gap${axis}: var(${pf}gap_item${axis});`\n\t\t\t\t);\n\n\t\t\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t\t\tslotted.append(\n\t\t\t\t\t\t`margin-${side}: var(${pf}gap${axis}) !important;`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// origContainer.append(\n\t\t\t// \t`width: 100%;\n\t\t\t// \tflex-grow: 0;`);\n\t\t});\n\n\t\tcontainer.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\titem.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\treset.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\tslotted.walk(i => { i.raws.before = \"\\n\\t\" });\n\n\t}\n\n\tfunction removeGap(rule) {\n\t\trule.walkDecls((decl) => {\n\t\t\tif (decl.prop === \"gap\" || decl.prop === \"column-gap\" || decl.prop === \"row-gap\") {\n\t\t\t\tif (typeof opts.flexGapNotSupported === 'undefined' || opts.flexGapNotSupported === \"\") {\n\t\t\t\t\t// Needs to be removed if option not defined\n\t\t\t\t\tdecl.remove()\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tfunction addWidth(decl) {\n\t\tfunction ifUnit(value) {\n\t\t\tvar regex = /^calc\\(|([0-9|.]+px|cm|mm|in|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)$/\n\t\t\treturn regex.test(value)\n\t\t}\n\n\t\tif (decl.prop === \"width\" || decl.prop === \"height\") {\n\t\t\tvar value = parse(decl.value).nodes[0];\n\t\t\tlet prop = decl.prop;\n\n\t\t\tif (decl.value === 0) {\n\t\t\t\tdecl.value = \"0px\";\n\t\t\t}\n\n\n\n\t\t\tif (ifUnit(decl.value)) {\n\t\t\t\tconst origContainer = decl.parent;\n\n\t\t\t\tconst container = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector}` });\n\t\t\t\tconst reset = postcss.rule({ selector: `${flexGapNotSupported}${origContainer.selector} > *` });\n\n\t\t\t\torigContainer.after(container);\n\t\t\t\tcontainer.before(reset);\n\n\t\t\t\tlet axis = prop === \"width\" ? \"_column\" : \"_row\";\n\n\t\t\t\t// Percentages\n\t\t\t\tif (value.unit === \"%\") {\n\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t`${pf}${prop}_percentages-decimal: ${value.number / 100} !important;`\n\t\t\t\t\t);\n\n\t\t\t\t\treset.append(\n\t\t\t\t\t\t`${pf}${prop}_percentages-decimal: initial;`\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Pixels, Ems\n\t\t\t\telse {\n\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t`${pf}gap_percentage-to-pixels_column: calc(-1 * ${decl.value} * var(${pf}gap_percentage-decimal${axis})) !important;\n\t\t\t${pf}gap_percentage-to-pixels_row: calc(-1 * ${decl.value} * var(${pf}gap_percentage-decimal${axis})) !important;`\n\t\t\t\t\t);\n\n\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t`${pf}${prop}: calc(${decl.value} - var(${pf}gap_container${axis}, 0%)) !important;`\n\t\t\t\t\t);\n\n\t\t\t\t\treset.append(\n\t\t\t\t\t\t`${pf}gap_percentage-to-pixels_column: initial;\n\t\t\t${pf}gap_percentage-to-pixels_row: initial;`\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tcontainer.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t\t\t\treset.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t\t\t}\n\t\t}\n\n\t}\n\n\tfunction hasGap(decl, obj) {\n\t\tif (decl.prop === \"gap\" || decl.prop === \"column-gap\" || decl.prop === \"row-gap\") {\n\t\t\tobj.hasGap = true;\n\t\t\tif (decl.prop === \"row-gap\") {\n\t\t\t\tobj.gapValues[0] = decl.value\n\t\t\t}\n\n\t\t\tif (decl.prop === \"column-gap\") {\n\t\t\t\tobj.gapValues[1] = decl.value\n\t\t\t}\n\n\n\n\t\t\tif (decl.prop === \"gap\") {\n\t\t\t\tobj.gapValues = postcss.list.space(decl.value);\n\t\t\t\tif (obj.gapValues.length === 1) {\n\t\t\t\t\tobj.gapValues.push(obj.gapValues[0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tfunction hasMargin(decl, obj) {\n\t\tif (decl.prop === \"margin\" || decl.prop === \"margin-left\" || decl.prop === \"margin-top\") {\n\t\t\tif (decl.prop === \"margin-top\") {\n\t\t\t\tobj.marginValues[0] = decl.value\n\t\t\t}\n\n\t\t\tif (decl.prop === \"margin-left\") {\n\t\t\t\tobj.marginValues[1] = decl.value\n\t\t\t}\n\n\t\t\tif (decl.prop === \"margin\") {\n\t\t\t\tobj.marginValues = postcss.list.space(decl.value);\n\t\t\t\tif (obj.marginValues.length === 1) {\n\t\t\t\t\tobj.marginValues.push(obj.marginValues[0]);\n\t\t\t\t}\n\t\t\t\tif (obj.marginValues.length > 1) {\n\t\t\t\t\tobj.marginValues = obj.marginValues.slice(0, 2);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfunction addRootSelector(root) {\n\t\tvar fileName = root.source.input.file\n\n\t\t// This avoids adding :root selector to module files used by Next.js\n\t\tif (!(fileName && fileName.endsWith(\".module.css\"))) {\n\t\t\tconst rootRule = postcss.rule({ selector: \":root\" });\n\n\t\t\troot.prepend(rootRule);\n\n\t\t\trootRule.append(\n\t\t\t\t`${pf}has-polyfil_gap-container: 0px;\n\t\t\t${pf}has-polyfil_gap-item: 0px;`\n\t\t\t);\n\n\t\t\trootRule.walk(i => { i.raws.before = \"\\n\\t\"; });\n\n\t\t}\n\t}\n\n\treturn {\n\t\tpostcssPlugin: 'postcss-gap',\n\t\tOnce(root) {\n\n\t\t\taddRootSelector(root)\n\n\t\t\troot.walkRules(rule => {\n\t\t\t\tvar obj = {\n\t\t\t\t\tgapValues: ['0px', '0px'],\n\t\t\t\t\tmarginValues: ['0px', '0px'],\n\t\t\t\t\thasGap: false,\n\t\t\t\t\thasFlex: false\n\t\t\t\t}\n\n\n\t\t\t\trule.walkDecls(function (decl) {\n\n\t\t\t\t\taddWidth(decl);\n\t\t\t\t\thasFlex(decl, obj);\n\t\t\t\t\thasGap(decl, obj)\n\t\t\t\t\thasMargin(decl, obj)\n\n\t\t\t\t});\n\n\t\t\t\tif (obj.hasGap && obj.hasFlex) {\n\t\t\t\t\taddGap(rule, obj.gapValues, obj.marginValues, opts);\n\t\t\t\t\tremoveGap(rule);\n\t\t\t\t}\n\t\t\t})\n\n\n\t\t}\n\t}\n}\n\nmodule.exports.postcss = true\n"],"names":["parse","require","module","exports","opts","pf","flexGapNotSupported","hasFlex","decl","obj","prop","origContainer","parent","container","postcss","rule","selector","item","value","after","before","append","walk","i","raws","addGap","values","marginValues","reset","slotted","properties","forEach","property","index","axis","side","number","nodes","unit","percentageRowGaps","webComponents","removeGap","walkDecls","remove","addWidth","ifUnit","regex","test","hasGap","gapValues","list","space","length","push","hasMargin","slice","addRootSelector","root","fileName","source","input","file","endsWith","rootRule","prepend","postcssPlugin","Once","walkRules"],"mappings":"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"}