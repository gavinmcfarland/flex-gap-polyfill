{"version":3,"file":"index.mjs","sources":["src/index.js"],"sourcesContent":["import postcss from \"postcss\";\nconst { parse } = require('postcss-values-parser');\n\nconst pf = \"--fgp-\";\n\nfunction hasFlex(decl, obj) {\n\n\tif (decl.prop === \"display\") {\n\t\tconst container = decl.parent;\n\n\t\tconst item = postcss.rule({ selector: `${container.selector} > *` });\n\n\t\tif (decl.value === \"flex\" || decl.value === \"inline-flex\") {\n\t\t\tcontainer.before(item);\n\n\t\t\tcontainer.append(\n\t\t\t\t`${pf}has-polyfil_gap-container: initial;`\n\t\t\t);\n\t\t\titem.append(\n\t\t\t\t`${pf}has-polyfil_gap-item: initial;`\n\t\t\t);\n\t\t}\n\n\t\titem.walk(i => { i.raws.before = \"\\n\\t\" });\n\t}\n\n\tif (decl.prop === \"display\" && decl.value === \"flex\") {\n\t\tobj.hasFlex = true;\n\t}\n\n\tif (decl.prop === \"display\" && decl.value === \"inline-flex\") {\n\t\tobj.hasFlex = true;\n\t}\n\n}\n\n\nfunction addGap(rule, values, marginValues, opts) {\n\n\tconst container = rule;\n\n\tconst item = postcss.rule({ selector: `${container.selector} > *` });\n\tconst reset = postcss.rule({ selector: `${container.selector} > * > *` });\n\tconst slotted = postcss.rule({ selector: `${container.selector} > ::slotted(*)` });\n\tcontainer.before(item);\n\titem.before(reset);\n\n\tconst properties = [\n\t\t[\"_row\", \"top\"],\n\t\t[\"_column\", \"left\"]\n\t];\n\n\tproperties.forEach((property, index) => {\n\n\t\tvar axis = property[0];\n\t\tvar side = property[1];\n\n\t\tvar value = values[index];\n\n\t\tif (value === \"0\") {\n\t\t\tvalue = \"0px\";\n\t\t}\n\t\tvar number = parse(value).nodes[0].value\n\t\tvar unit = parse(value).nodes[0].unit;\n\n\t\tvar percentageRowGaps = opts.percentageRowGaps || unit != \"%\" && axis === \"_row\";\n\n\t\t// Percentages\n\t\tif (unit === \"%\") {\n\t\t\t// formula: (parent - self) / (100 - self) * 100\n\t\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}gap_percentage-decimal${axis}: ${number / 100};\n\t\t\t\t${pf}gap_container${axis}: var(${pf}has-polyfil_gap-container, var(${pf}gap_percentage-to-pixels${axis}, calc( ((var(${pf}gap_parent${axis}, 0%) - ${value}) * var(${pf}width_percentages-decimal, 1)) / (100 - ${number}) * 100))) !important;`\n\t\t\t\t);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}gap_container${axis}: var(--fgp-gap_item_row) !important;`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Pixels, Ems\n\t\telse {\n\t\t\t// formula: (parent - self)\n\t\t\tcontainer.append(\n\t\t\t\t`${pf}gap_container${axis}: var(${pf}has-polyfil_gap-container, calc(var(${pf}gap_parent${axis}, 0px) - ${value})) !important;`\n\t\t\t);\n\n\t\t}\n\n\t\treset.append(\n\t\t\t`${pf}gap_item${axis}: initial;`\n\t\t);\n\n\t\titem.append(\n\t\t\t`pointer-events: all;\n\t\t\t${pf}gap_container${axis}: initial;\n\t\t\t${pf}gap_item${axis}: var(${pf}has-polyfil_gap-item, ${value}) !important;\n\t\t\t${pf}gap${axis}: var(${pf}gap_item${axis});`\n\t\t);\n\n\n\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\titem.append(\n\t\t\t\t`${pf}gap_parent${axis}: var(${pf}has-polyfil_gap-item, ${value}) !important;\n\t\t\t\t\tmargin-${side}: var(${pf}gap${axis});`\n\t\t\t);\n\t\t}\n\n\t\tcontainer.append(\n\t\t\t`pointer-events: none;\n\t\t\t${pf}gap_parent${axis}: initial;\n\t\t\t${pf}gap_item${axis}: initial;\n\t\t\t${pf}gap${axis}: var(${pf}gap_container${axis}) !important;\n\t\t\tpadding-top: 0.02px;`\n\t\t);\n\n\n\n\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t// Moved !important to from margin property to custom property. Not sure if this breaks anything\n\t\t\tcontainer.append(\n\t\t\t\t`${pf}margin-${side}: calc(var(${pf}gap${axis}) + ${marginValues[0]}) !important;\n\t\t\t\t\tmargin-${side}: var(${pf}margin-${side});`\n\t\t\t);\n\t\t}\n\n\n\t\t// If web components\n\t\tif (opts.webComponents === true) {\n\t\t\tcontainer.before(slotted);\n\n\t\t\tslotted.append(\n\t\t\t\t`${pf}gap_parent${axis}: ${value};\n\t\t\t\t${pf}gap_item${axis}: ${value};\n\t\t\t\t${pf}gap${axis}: var(${pf}gap_item${axis});`\n\t\t\t);\n\n\t\t\tif ((percentageRowGaps && axis === \"_row\") || axis === \"_column\") {\n\t\t\t\tslotted.append(\n\t\t\t\t\t`margin-${side}: var(${pf}gap${axis}) !important;`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// container.append(\n\t\t// \t`width: 100%;\n\t\t// \tflex-grow: 0;`);\n\t});\n\n\tcontainer.walk(i => { i.raws.before = \"\\n\\t\" });\n\titem.walk(i => { i.raws.before = \"\\n\\t\" });\n\treset.walk(i => { i.raws.before = \"\\n\\t\" });\n\tslotted.walk(i => { i.raws.before = \"\\n\\t\" });\n\n}\n\nfunction removeGap(rule) {\n\trule.walkDecls((decl) => {\n\t\tif (decl.prop === \"gap\" || decl.prop === \"column-gap\" || decl.prop === \"row-gap\") {\n\t\t\tdecl.remove()\n\t\t}\n\t})\n}\n\nfunction addWidth(decl) {\n\tfunction ifUnit(value) {\n\t\tvar regex = /^calc\\(|([0-9|.]+px|cm|mm|in|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)$/\n\t\treturn regex.test(value)\n\t}\n\n\tif (decl.prop === \"width\" || decl.prop === \"height\") {\n\t\tvar value = parse(decl.value).nodes[0];\n\t\tlet prop = decl.prop;\n\n\t\tif (decl.value === 0) {\n\t\t\tdecl.value = \"0px\";\n\t\t}\n\n\n\n\t\tif (ifUnit(decl.value)) {\n\t\t\tconst container = decl.parent;\n\t\t\tconst reset = postcss.rule({ selector: `${container.selector} > *` });\n\n\t\t\tcontainer.before(reset);\n\n\t\t\tlet axis = prop === \"width\" ? \"_column\" : \"_row\";\n\n\t\t\t// Percentages\n\t\t\tif (value.unit === \"%\") {\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}${prop}_percentages-decimal: ${value.number / 100} !important;`\n\t\t\t\t);\n\n\t\t\t\treset.append(\n\t\t\t\t\t`${pf}${prop}_percentages-decimal: initial;`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Pixels, Ems\n\t\t\telse {\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}gap_percentage-to-pixels_column: calc(-1 * ${decl.value} * var(${pf}gap_percentage-decimal${axis})) !important;\n\t\t\t${pf}gap_percentage-to-pixels_row: calc(-1 * ${decl.value} * var(${pf}gap_percentage-decimal${axis})) !important;`\n\t\t\t\t);\n\n\t\t\t\tcontainer.append(\n\t\t\t\t\t`${pf}${prop}: calc(${decl.value} - var(${pf}gap_container${axis}, 0%)) !important;`\n\t\t\t\t);\n\n\t\t\t\treset.append(\n\t\t\t\t\t`${pf}gap_percentage-to-pixels_column: initial;\n\t\t\t${pf}gap_percentage-to-pixels_row: initial;`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tcontainer.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t\t\treset.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t\t}\n\t}\n\n}\n\nfunction hasGap(decl, obj) {\n\tif (decl.prop === \"gap\" || decl.prop === \"column-gap\" || decl.prop === \"row-gap\") {\n\t\tobj.hasGap = true;\n\t\tif (decl.prop === \"row-gap\") {\n\t\t\tobj.gapValues[0] = decl.value\n\t\t}\n\n\t\tif (decl.prop === \"column-gap\") {\n\t\t\tobj.gapValues[1] = decl.value\n\t\t}\n\n\n\n\t\tif (decl.prop === \"gap\") {\n\t\t\tobj.gapValues = postcss.list.space(decl.value);\n\t\t\tif (obj.gapValues.length === 1) {\n\t\t\t\tobj.gapValues.push(obj.gapValues[0]);\n\t\t\t}\n\t\t}\n\n\t}\n}\n\nfunction hasMargin(decl, obj) {\n\tif (decl.prop === \"margin\" || decl.prop === \"margin-left\" || decl.prop === \"margin-top\") {\n\t\tif (decl.prop === \"margin-top\") {\n\t\t\tobj.marginValues[0] = decl.value\n\t\t}\n\n\t\tif (decl.prop === \"margin-left\") {\n\t\t\tobj.marginValues[1] = decl.value\n\t\t}\n\n\t\tif (decl.prop === \"margin\") {\n\t\t\tobj.marginValues = postcss.list.space(decl.value);\n\t\t\tif (obj.marginValues.length === 1) {\n\t\t\t\tobj.marginValues.push(obj.marginValues[0]);\n\t\t\t}\n\t\t\tif (obj.marginValues.length > 1) {\n\t\t\t\tobj.marginValues = obj.marginValues.slice(0, 2);\n\t\t\t}\n\t\t}\n\t}\n}\nfunction addRootSelector(root) {\n\tvar fileName = root.source.input.file\n\n\t// This avoids adding :root selector to module files used by Next.js\n\tif (!(fileName && fileName.endsWith(\".module.css\"))) {\n\t\tconst rootRule = postcss.rule({ selector: \":root\" });\n\n\t\troot.prepend(rootRule);\n\n\t\trootRule.append(\n\t\t\t`${pf}has-polyfil_gap-container: 0px;\n\t\t\t${pf}has-polyfil_gap-item: 0px;`\n\t\t);\n\n\t\trootRule.walk(i => { i.raws.before = \"\\n\\t\"; });\n\n\t}\n}\n\nmodule.exports = (opts = {}) => {\n\topts = opts || {}\n\treturn {\n\t\tpostcssPlugin: 'postcss-gap',\n\t\tOnce(root) {\n\n\t\t\taddRootSelector(root)\n\n\t\t\troot.walkRules(rule => {\n\t\t\t\tvar obj = {\n\t\t\t\t\tgapValues: ['0px', '0px'],\n\t\t\t\t\tmarginValues: ['0px', '0px'],\n\t\t\t\t\thasGap: false,\n\t\t\t\t\thasFlex: false\n\t\t\t\t}\n\n\n\t\t\t\trule.walkDecls(function (decl) {\n\n\t\t\t\t\taddWidth(decl);\n\t\t\t\t\thasFlex(decl, obj);\n\t\t\t\t\thasGap(decl, obj)\n\t\t\t\t\thasMargin(decl, obj)\n\n\t\t\t\t});\n\n\t\t\t\tif (obj.hasGap && obj.hasFlex) {\n\t\t\t\t\taddGap(rule, obj.gapValues, obj.marginValues, opts);\n\t\t\t\t\tremoveGap(rule);\n\t\t\t\t}\n\t\t\t})\n\n\n\t\t}\n\t}\n}\n\nmodule.exports.postcss = true\n"],"names":["parse","require","pf","hasFlex","decl","obj","prop","container","parent","item","postcss","rule","selector","value","before","append","walk","i","raws","addGap","values","marginValues","opts","reset","slotted","properties","forEach","property","index","axis","side","number","nodes","unit","percentageRowGaps","webComponents","removeGap","walkDecls","remove","addWidth","ifUnit","regex","test","hasGap","gapValues","list","space","length","push","hasMargin","slice","addRootSelector","root","fileName","source","input","file","endsWith","rootRule","prepend","module","exports","postcssPlugin","Once","walkRules"],"mappings":"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"}