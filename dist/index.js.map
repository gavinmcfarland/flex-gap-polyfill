{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import postcss from \"postcss\";\nimport { parse } from 'postcss-values-parser';\n\n// var twMarginRegex = /^.-?m(y-[0-9]|x-[0-9]|-px|-[0-9].?[0-9]?)/gmi\n\n// TODO: To support Tailwind need to cover all variants of class names including device eg md:. margin, width, flex, height\n\n// TODO: Test with example repos\n// TODO: Check webComponents option works\n// TODO: Check works with tailwind\n\nmodule.exports = (opts = {}) => {\n\topts = opts || {}\n\n\tconst pf = \"fgp-\";\n\tconst flexGapNotSupported = opts.flexGapNotSupported ? opts.flexGapNotSupported + \" \" : \"\";\n\n\tfunction getFlex(decl, obj) {\n\t\tif (decl.prop === \"display\" && decl.value === \"flex\" || decl.prop === \"display\" && decl.value === \"inline-flex\") {\n\t\t\tobj.hasFlex = true;\n\t\t}\n\t}\n\n\tfunction getWidth(decl, obj) {\n\t\tif (decl.prop === \"width\") {\n\t\t\tobj.hasWidth = true\n\t\t}\n\t\tif (decl.prop === \"height\") {\n\t\t\tobj.hasHeight = true\n\t\t}\n\t}\n\n\tfunction getGap(decl, obj) {\n\t\tif (decl.prop === \"gap\" || decl.prop === \"column-gap\" || decl.prop === \"row-gap\") {\n\t\t\tobj.hasGap = true;\n\t\t\tif (decl.prop === \"row-gap\") {\n\t\t\t\tobj.gapValues[0] = decl.value\n\t\t\t}\n\n\t\t\tif (decl.prop === \"column-gap\") {\n\t\t\t\tobj.gapValues[1] = decl.value\n\t\t\t}\n\n\t\t\tif (decl.prop === \"gap\") {\n\t\t\t\tobj.gapValues = postcss.list.space(decl.value);\n\t\t\t\tif (obj.gapValues.length === 1) {\n\t\t\t\t\tobj.gapValues.push(obj.gapValues[0]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\tfunction getMargin(decl, obj) {\n\t\tif (decl.prop === \"margin\" || decl.prop === \"margin-left\" || decl.prop === \"margin-top\") {\n\t\t\tvar value;\n\t\t\tobj.hasMargin = true\n\t\t\tif (decl.prop === \"margin-top\") {\n\t\t\t\tif (decl.value === \"0\") {\n\t\t\t\t\tvalue = '0px'\n\t\t\t\t}\n\t\t\t\tobj.marginValues[0] = value\n\t\t\t}\n\n\n\n\t\t\tif (decl.prop === \"margin\") {\n\t\t\t\tobj.marginValues = postcss.list.space(decl.value);\n\n\t\t\t\tif (decl.prop === \"margin-left\") {\n\t\t\t\t\tif (decl.value === \"0\") {\n\t\t\t\t\t\tvalue = '0px'\n\t\t\t\t\t}\n\t\t\t\t\tobj.marginValues[3] = value\n\t\t\t\t}\n\n\t\t\t\tif (obj.marginValues[0] === \"0\") {\n\t\t\t\t\tobj.marginValues[0] = '0px'\n\t\t\t\t}\n\n\t\t\t\tif (obj.marginValues[1] === \"0\") {\n\t\t\t\t\tobj.marginValues[1] = '0px'\n\t\t\t\t}\n\n\t\t\t\tswitch (obj.marginValues.length) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tobj.marginValues.push(obj.marginValues[0]);\n\t\t\t\t\t// falls through\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tobj.marginValues.push(obj.marginValues[0]);\n\t\t\t\t\t// falls through\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tobj.marginValues.push(obj.marginValues[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction getRules(decl, obj, root) {\n\t\tvar fileName = root.source.input.file\n\t\tobj.rules.orig = decl.parent\n\n\t\tvar selector;\n\n\n\t\t// These are needed to specifiy global scope for CSS modules\n\t\tvar cssModule = \"\";\n\t\tvar cssModuleEnd = \"\"\n\n\t\tif ((fileName && fileName.endsWith(\".module.css\")) && opts.flexGapNotSupported) {\n\t\t\tcssModule = \":global(\"\n\t\t\tcssModuleEnd = \") \"\n\t\t}\n\n\t\t// if (obj.hasGap && obj.hasFlex) {\n\t\tselector = {\n\t\t\tcontainer: `${cssModule}${flexGapNotSupported}${cssModuleEnd}${obj.rules.orig.selector}`,\n\t\t\titem: `${cssModule}${flexGapNotSupported}${cssModuleEnd}${obj.rules.orig.selector} > *`,\n\t\t\treset: `${cssModule}${flexGapNotSupported}${cssModuleEnd}${obj.rules.orig.selector} > * > *`\n\t\t};\n\n\t\tif (opts.webComponents) {\n\t\t\tselector.item = `${cssModule}${flexGapNotSupported}${cssModuleEnd}${obj.rules.orig.selector} > *,\n${cssModule}${flexGapNotSupported}${cssModuleEnd}${obj.rules.orig.selector} > ::slotted(*)`\n\t\t}\n\t\t// }\n\n\t\t// if ((opts.tailwindCSS && /^.gap(?=\\b|[0-9])/gmi.test(obj.rules.orig.selector) && !obj.hasFlex) || (obj.hasWidth || obj.hasHeight) || (opts.tailwindCSS && /^.-?m(y-[0-9]|x-[0-9]|-px|-[0-9].?[0-9]?)/gmi.test(obj.rules.orig.selector) && !obj.hasFlex)) {\n\t\t// \tselector = {\n\t\t// \t\tcontainer: `${cssModule}${flexGapNotSupported}${cssModuleEnd}.flex${obj.rules.orig.selector}, ${cssModule}${flexGapNotSupported}${cssModuleEnd}.inline-flex${obj.rules.orig.selector}`,\n\t\t// \t\titem: `${cssModule}${flexGapNotSupported}${cssModuleEnd}.flex${obj.rules.orig.selector} > *, ${cssModule}${flexGapNotSupported}${cssModuleEnd}.inline-flex${obj.rules.orig.selector} > *`,\n\t\t// \t\treset: `${cssModule}${flexGapNotSupported}${cssModuleEnd}.flex${obj.rules.orig.selector} > * > *, ${cssModule}${flexGapNotSupported}${cssModuleEnd}.inline-flex${obj.rules.orig.selector} > * > *`,\n\t\t// \t\tslotted: `${cssModule}${flexGapNotSupported}${cssModuleEnd}.flex${obj.rules.orig.selector} > ::slotted(*), ${cssModule}${flexGapNotSupported}${cssModuleEnd}.inline-flex${obj.rules.orig.selector} > ::slotted(*)`\n\t\t// \t};\n\t\t// }\n\n\t\tobj.rules.container = postcss.rule({ selector: selector.container });\n\t\tobj.rules.item = postcss.rule({ selector: selector.item });\n\t\tobj.rules.reset = postcss.rule({ selector: selector.reset });\n\n\t\tobj.rules.container.prepend(postcss.comment({ text: 'added by fgp' }))\n\t\tobj.rules.item.prepend(postcss.comment({ text: 'added by fgp' }))\n\t\tobj.rules.reset.prepend(postcss.comment({ text: 'added by fgp' }))\n\t}\n\n\tfunction addRootSelector(root) {\n\t\tvar fileName = root.source.input.file\n\n\t\t// This avoids adding :root selector to module files used by Next.js\n\t\tif (!(fileName && fileName.endsWith(\".module.css\"))) {\n\t\t\tconst rootRule = postcss.rule({ selector: \":root\" });\n\n\t\t\troot.prepend(rootRule);\n\t\t\trootRule.prepend(postcss.comment({ text: 'added by fgp' }))\n\n\t\t\trootRule.append(\n\t\t\t\t`--has-fgp: initial;\n\t\t\t\t--parent-has-fgp: initial;`\n\t\t\t);\n\n\t\t\trootRule.walk(i => { i.raws.before = \"\\n\\t\"; });\n\n\t\t}\n\t}\n\n\t// function addWidth(rule, obj) {\n\t// \tfunction ifUnit(value) {\n\t// \t\tvar regex = /^calc\\(|([0-9|.]+px|cm|mm|in|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)$/\n\t// \t\treturn regex.test(value)\n\t// \t}\n\n\t// \tif (obj.hasWidth || obj.hasHeight) {\n\t// \t\trule.walkDecls((decl) => {\n\t// \t\t\tvar value = parse(decl.value).nodes[0];\n\t// \t\t\tlet prop = decl.prop;\n\n\t// \t\t\tif (decl.value === 0) {\n\t// \t\t\t\tdecl.value = \"0px\";\n\t// \t\t\t}\n\n\t// \t\t\tif (ifUnit(decl.value)) {\n\t// \t\t\t\tconst origContainer = obj.rules.orig;\n\t// \t\t\t\tconst container = obj.rules.container\n\t// \t\t\t\tconst reset = obj.rules.reset;\n\n\t// \t\t\t\torigContainer.after(container);\n\t// \t\t\t\tcontainer.before(reset);\n\n\t// \t\t\t\tlet axis = prop === \"width\" ? \"column\" : \"row\";\n\n\t// \t\t\t\t// Percentages\n\t// \t\t\t\tif (value.unit === \"%\") {\n\t// \t\t\t\t\tcontainer.append(\n\t// \t\t\t\t\t\t`${pf}${prop}-percentages-decimal: ${value.number / 100} !important;`\n\t// \t\t\t\t\t);\n\n\t// \t\t\t\t\treset.append(\n\t// \t\t\t\t\t\t`${pf}${prop}-percentages-decimal: initial;`\n\t// \t\t\t\t\t);\n\t// \t\t\t\t}\n\n\t// \t\t\t\t// Pixels, Ems\n\t// \t\t\t\telse {\n\t// \t\t\t\t\tcontainer.append(\n\t// \t\t\t\t\t\t`${pf}gap-percentage-to-pixels-column: calc(-1 * ${decl.value} * var(${pf}gap_percentage-decimal-${axis})) !important;\n\t// \t\t${pf}gap-percentage-to-pixels-row: calc(-1 * ${decl.value} * var(${pf}gap-percentage-decimal-${axis})) !important;`\n\t// \t\t\t\t\t);\n\n\t// \t\t\t\t\tcontainer.append(\n\t// \t\t\t\t\t\t`${pf}${prop}: calc(${decl.value} - var(${pf}gap-container-${axis}, 0%)) !important;`\n\t// \t\t\t\t\t);\n\n\t// \t\t\t\t\treset.append(\n\t// \t\t\t\t\t\t`${pf}gap-percentage-to-pixels-column: initial;\n\t// \t\t${pf}gap-percentage-to-pixels-row: initial;`\n\t// \t\t\t\t\t);\n\t// \t\t\t\t}\n\n\t// \t\t\t\tcontainer.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t// \t\t\t\treset.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t// \t\t\t}\n\t// \t\t})\n\t// \t}\n\t// }\n\n\t// function addFlex(rule, obj) {\n\t// \t// if (obj.hasFlex) {\n\t// \tconst origContainer = obj.rules.orig;\n\t// \tconst container = obj.rules.container;\n\t// \tconst item = obj.rules.item\n\n\t// \torigContainer.after(container);\n\n\t// \tcontainer.before(item);\n\n\t// \tcontainer.append(\n\t// \t\t`${pf}has-polyfill-gap-container: initial;`\n\t// \t);\n\t// \titem.append(\n\t// \t\t`${pf}has-polyfill-gap-item: initial;`\n\t// \t);\n\n\t// \titem.walk(i => { i.raws.before = \"\\n\\t\" });\n\t// \t// }\n\n\t// }\n\n\tfunction rewriteFlex(rule, obj) {\n\n\t\trule.walkDecls((decl) => {\n\t\t\tif (decl.prop === \"display\" && decl.value === \"flex\" || decl.prop === \"display\" && decl.value === \"inline-flex\") {\n\n\t\t\t\tobj.rules.container.append(`--has-fgp: ;`)\n\n\t\t\t\tobj.rules.item.append(`--parent-has-fgp: !important;`)\n\n\t\t\t\tobj.rules.reset.append(`--parent-has-fgp: initial;`)\n\n\t\t\t}\n\n\t\t})\n\t}\n\n\tfunction rewriteMargin(rule, obj) {\n\n\t\tlet { orig, container, item} = obj.rules\n\n\t\t// 1. Replace existing margin-left and margin-top\n\t\torig.walkDecls((decl) => {\n\t\t\tif (decl.prop === \"margin-top\" || decl.prop === \"margin-left\") {\n\t\t\t\t// don't do this is margin is auto because cannot calc with auto\n\t\t\t\tif (decl.value !== \"auto\") {\n\t\t\t\t\tvar value = decl.value;\n\t\t\t\t\tif (value === \"0\") {\n\t\t\t\t\t\tvalue = \"0px\";\n\t\t\t\t\t}\n\t\t\t\t\tdecl.before(`--${pf}${decl.prop}: initial;`)\n\t\t\t\t\tdecl.before(`--orig-${decl.prop}: ${value};`);\n\t\t\t\t\tdecl.value = `var(--${pf}${decl.prop}, var(--orig-${decl.prop}))`\n\n\t\t\t\t\titem.append(`--orig-${decl.prop}: initial;`)\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (decl.prop === \"margin\") {\n\t\t\t\t// TODO: Need to catch when value is auto as can't work with calc\n\t\t\t\tdecl.before(`--${pf}margin-top: initial;`);\n\t\t\t\tdecl.before(`--${pf}margin-left: initial;`);\n\t\t\t\t\tdecl.before(`--orig-margin-top: ${obj.marginValues[0]};`);\n\t\t\t\t\tdecl.before(`--orig-margin-right: ${obj.marginValues[1]};`);\n\t\t\t\t\tdecl.before(`--orig-margin-bottom: ${obj.marginValues[2]};`);\n\t\t\t\t\tdecl.before(`--orig-margin-left: ${obj.marginValues[3]};`);\n\t\t\t\tdecl.value = `var(--${pf}margin-top, var(--orig-margin-top)) var(--orig-margin-right) var(--orig-margin-bottom) var(--${pf}margin-left, var(--orig-margin-left))`\n\n\t\t\t\titem.append(`--orig-margin-top: initial;`)\n\t\t\t\titem.append(`--orig-margin-right: initial;`)\n\t\t\t\titem.append(`--orig-margin-bottom: initial;`)\n\t\t\t\titem.append(`--orig-margin-left: initial;`)\n\t\t\t}\n\t\t})\n\n\t\t// 2. Add margin when gap present\n\t\tconst properties = [\n\t\t\t[\"row\", \"top\"],\n\t\t\t[\"column\", \"left\"]\n\t\t];\n\n\t\t// Disable gap when element has display flex\n\t\t// TODO: Needs modifying to work on gap shorthand\n\t\torig.walkDecls((decl) => {\n\t\t\tif (decl.prop === \"gap\" || decl.prop === \"row-gap\" || decl.prop === \"column-gap\") {\n\t\t\t\t// don't do this is margin is auto because cannot calc with auto\n\t\t\t\tdecl.before(`--${pf}${decl.prop}: var(--has-fgp, ${decl.value})`)\n\t\t\t\tdecl.value = `var(--${pf}${decl.prop}, 0px)`\n\t\t\t}\n\t\t})\n\n\t\tif (obj.hasFlex || obj.hasGap) {\n\t\tcontainer.append(`pointer-events: var(--has-fgp) none;`)\n\t\titem.append(`pointer-events: var(--parent-has-fgp) auto;`)\n\t\t}\n\n\n\t\tproperties.forEach((property, index) => {\n\t\t\tvar axis = property[0];\n\t\t\tvar side = property[1];\n\t\t\tvar value = obj.gapValues[index];\n\t\t\tvar gapNumber = axis === \"row\" ? 0 : 1;\n\t\t\tvar marginNumber = axis === \"row\" ? 0 : 3;\n\t\t\tif (value === \"0\") {\n\t\t\t\tvalue = \"0px\";\n\t\t\t}\n\n\n\n\t\t\t// Only add if gap is not null\n\t\t\tif ((obj.gapValues[gapNumber] !== null)) {\n\n\n\t\t\t\t// Don't add margin if rule already contains margin\n\t\t\t\tif (!obj.marginValues[marginNumber] && obj.marginValues[marginNumber] !== 0) {\n\t\t\t\t\torig.append(`margin-${side}: var(--${pf}margin-${side}, var(--orig-margin-${side}));`)\n\t\t\t\t}\n\n\n\t\t\t\tif (parse(value).nodes[0].unit === \"%\") {\n\t\t\t\t\tvar unitlessPercentage = parse(value).nodes[0].value / 100\n\t\t\t\t\t// formula: (parent - self) / (100 - 1 + percentageAsDecimal) * 100\n\t\t\t\t\tif (side !== \"top\") {\n\t\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t\t`--${pf}gap-${axis}: ${value};\n\t\t\t\t\t\t--${pf}-parent-gap-as-decimal: ${unitlessPercentage};\n\t\t\t\t\t\t`)\n\t\t\t\t\t\tcontainer.append(`--${pf}margin-${side}: calc(\n\t\t\t\t\t\t(var(--${pf}parent-gap-${axis}, 0px) - var(--${pf}gap-${axis}) / (100 - (1 + ${unitlessPercentage})) * 100)\n\t\t\t\t\t\t+ var(--${pf}orig-margin-${side}, 0px)\n\t\t\t\t\t\t) !important`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// formula: (parent - self)\n\t\t\t\t\tcontainer.append(\n\t\t\t\t\t\t`--${pf}gap-${axis}: ${value};`\n\t\t\t\t\t)\n\t\t\t\t\tcontainer.append(`--${pf}margin-${side}: var(--has-fgp) calc(var(--${pf}parent-gap-${axis}, 0px) / (1 + var(--${pf}-parent-gap-as-decimal, 0)) - var(--${pf}gap-${axis}) + var(--orig-margin-${side}, 0px)) !important;`\n\t\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tif (parse(value).nodes[0].unit === \"%\") {\n\t\t\t\t\tif (side !== \"top\") {\n\t\t\t\t\t\titem.append(\n\t\t\t\t\t\t\t`--${pf}parent-gap-${axis}: ${value};\n\t\t\t\t\t--${pf}margin-${side}: var(--parent-has-fgp) calc(var(--${pf}gap-${axis}) / (1 + ${unitlessPercentage}) + var(--orig-margin-${side}, 0px));`\n\t\t\t\t\t\t)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\titem.append(\n\t\t\t\t\t\t`--${pf}parent-gap-${axis}: ${value};\n\t\t\t\t\t--${pf}margin-${side}: var(--parent-has-fgp) calc(var(--${pf}gap-${axis}) + var(--orig-margin-${side}, 0px));`\n\t\t\t\t\t)\n\t\t\t\t}\n\n\t\t\t\t// Add margin to items\n\t\t\t\titem.append(`margin-${side}: var(--${pf}margin-${side});`)\n\n\t\t\t}\n\t\t})\n\n\t}\n\n\t// function addGap(rule, obj, opts) {\n\n\t// \tconst origContainer = obj.rules.orig;\n\t// \tconst container = obj.rules.container\n\t// \tconst item = obj.rules.item\n\t// \tconst reset = obj.rules.reset\n\t// \tconst slotted = obj.rules.slotted\n\n\t// \tconst properties = [\n\t// \t\t[\"row\", \"top\"],\n\t// \t\t[\"column\", \"left\"]\n\t// \t];\n\n\t// \torigContainer.after(container);\n\t// \tcontainer.before(item);\n\t// \titem.before(reset);\n\n\t// \t// Just a precaution incase flex gap detection has false positive\n\t// \tif (opts.flexGapNotSupported) {\n\t// \t\tcontainer.append(\n\t// \t\t\t`gap: 0;`\n\t// \t\t)\n\t// \t}\n\n\t// \tproperties.forEach((property, index) => {\n\n\t// \t\tvar axis = property[0];\n\t// \t\tvar side = property[1];\n\n\t// \t\tvar value = obj.gapValues[index];\n\n\t// \t\tif (value === \"0\") {\n\t// \t\t\tvalue = \"0px\";\n\t// \t\t}\n\n\t// \t\tvar unit = parse(value).nodes[0].unit;\n\n\t// \t\tvar percentageRowGaps = opts.percentageRowGaps || unit != \"%\" && axis === \"row\";\n\t// \t\tvar axisNumber = axis === \"row\" ? 0 : 1\n\n\t// \t\t// Percentages\n\t// \t\tif (unit === \"%\") {\n\t// \t\t\t// formula: (parent - self) / (100 - self) * 100\n\t// \t\t\tvar unitlessPercentage = parse(value).nodes[0].value\n\n\t// \t\t\tcontainer.append(\n\t// \t\t\t\t`--${pf}orig-margin-${side}: ${obj.marginValues[axisNumber]};\n\t// \t\t\t\t--${pf}gap-${axis}: ${value};\n\t// \t\t\t\t--${pf}margin-${side}: calc(\n\t// \t\t\t\t\t(var(--${pf}parent-gap-${axis}, 0px) - var(--${pf}gap-${axis}) / (100 - ${unitlessPercentage}) * 100)\n\t// \t\t\t\t\t+ var(--${pf}orig-margin-${side})\n\t// \t\t\t\t\t) !important;\n\t// \t\t\t\tmargin-${side}: var(--has-display-flex) var(--${pf}margin-${side});`\n\t// \t\t\t);\n\n\t// \t\t\t// if ((percentageRowGaps && axis === \"row\") || axis === \"column\") {\n\t// \t\t\t// \tcontainer.append(\n\t// \t\t\t// \t\t`${pf}gap-percentage-decimal-${axis}: ${number / 100};\n\t// \t\t\t// ${pf}gap-container-${axis}: var(${pf}has-polyfill-gap-container, var(${pf}gap-percentage-to-pixels-${axis}, calc( ((var(${pf}gap-parent-${axis}, 0%) - ${value}) * var(${pf}width-percentages-decimal, 1)) / (100 - ${number}) * 100))) !important;`\n\t// \t\t\t// \t);\n\t// \t\t\t// }\n\t// \t\t\t// else {\n\t// \t\t\t// \tcontainer.append(\n\t// \t\t\t// \t\t`${pf}gap-container-${axis}: var(--fgp-gap-item-row) !important;`\n\t// \t\t\t// \t);\n\t// \t\t\t// }\n\t// \t\t}\n\n\t// \t\t// Pixels, Ems\n\t// \t\telse {\n\t// \t\t\t// formula: (parent - self)\n\t// \t\t\tcontainer.append(\n\t// \t\t\t\t`--${pf}orig-margin-${side}: ${obj.marginValues[axisNumber]};\n\t// \t\t\t\t--${pf}gap-${axis}: ${value};\n\t// \t\t\t\t--${pf}margin-${side}: calc(var(--${pf}parent-gap-${axis}, 0px) - var(--${pf}gap-${axis}) + var(--${pf}orig-margin-${side})) !important;\n\t// \t\t\t\tmargin-${side}: var(--has-display-flex) var(--${pf}margin-${side});`\n\t// \t\t\t);\n\n\t// \t\t\t// ${pf}gap-container-${axis}: var(${pf}has-polyfill-gap-container, calc(var(${pf}gap-parent-${axis}, 0px) - ${value})) !important;\n\n\t// \t\t}\n\n\t// \t\t// reset.append(\n\t// \t\t// \t`${pf}gap-item-${axis}: initial;`\n\t// \t\t// );\n\n\t// \t\titem.append(\n\t// \t\t\t`--${pf}parent-gap-${axis}: ${value};\n\t// \t\t\t--${pf}margin-${side}: var(--${pf}gap-${axis});\n\t// \t\t\tmargin-${side}: var(--${pf}margin-${side});`\n\t// \t\t);\n\n\t// \t\t// ${pf}gap-container-${axis}: initial;\n\t// \t\t// ${pf}gap-item-${axis}: var(${pf}has-polyfill-gap-item, ${value}) !important;\n\t// \t\t// ${pf}gap-${axis}: var(${pf}gap-item-${axis});\n\n\n\t// \t\tif ((percentageRowGaps && axis === \"row\") || axis === \"column\") {\n\t// \t\t\t// item.append(\n\t// \t\t\t// \t`${pf}gap-parent-${axis}: var(${pf}has-polyfill-gap-item, ${value}) !important;\n\t// \t\t\t// \tmargin-${side}: var(${pf}gap-${axis});`\n\t// \t\t\t// );\n\t// \t\t}\n\n\t// \t\t// container.append(\n\t// \t\t// \t`${pf}gap-parent-${axis}: initial;\n\t// \t\t// ${pf}gap-item-${axis}: initial;\n\t// \t\t// ${pf}gap-${axis}: var(${pf}gap-container-${axis}) !important;`\n\t// \t\t// );\n\n\t// \t\t// if ((percentageRowGaps && axis === \"row\") || axis === \"column\") {\n\t// \t\t// \t// Needed to switch margin values depending on row/top or column/left marginValues => [top, left] // may need changing to [top, right, bottom, left]?\n\t// \t\t// \tvar axisNumber = axis === \"row\" ? 0 : 1\n\t// \t\t// \t// Moved !important to from margin property to custom property. Not sure if this breaks anything\n\t// \t\t// \tcontainer.append(\n\t// \t\t// \t\t`${pf}margin-${side}: calc(var(${pf}gap-${axis}) + ${obj.marginValues[axisNumber]}) !important;\n\t// \t\t// \t\tmargin-${side}: var(${pf}margin-${side});`\n\t// \t\t// \t);\n\t// \t\t// }\n\n\t// \t\t// If web components\n\t// \t\tif (opts.webComponents === true) {\n\t// \t\t\t// container.before(slotted);\n\n\t// \t\t\t// slotted.append(\n\t// \t\t\t// \t`${pf}gap-parent-${axis}: ${value};\n\t// \t\t\t// ${pf}gap-item-${axis}: ${value};\n\t// \t\t\t// ${pf}gap-${axis}: var(${pf}gap-item-${axis});`\n\t// \t\t\t// );\n\n\t// \t\t\t// if ((percentageRowGaps && axis === \"row\") || axis === \"column\") {\n\t// \t\t\t// \tslotted.append(\n\t// \t\t\t// \t\t`margin-${side}: var(${pf}gap-${axis}) !important;`\n\t// \t\t\t// \t);\n\t// \t\t\t// }\n\t// \t\t}\n\n\t// \t});\n\n\t// \titem.append(`pointer-events: all;`)\n\t// \tcontainer.append(\n\t// \t\t`pointer-events: none;\n\t// \tpadding-top: 0.02px;`)\n\n\t// \tcontainer.walk(i => { i.raws.before = \"\\n\\t\" });\n\t// \titem.walk(i => { i.raws.before = \"\\n\\t\" });\n\t// \treset.walk(i => { i.raws.before = \"\\n\\t\" });\n\t// \tslotted.walk(i => { i.raws.before = \"\\n\\t\" });\n\n\t// }\n\n\t// function addMargin(rule, obj) {\n\t// \t// Rewrites margin properties for:\n\t// \t// margin: 1em; => margin: calc() 1em calc();\n\t// \t// margin-top: 1em; => margin-top: calc();\n\t// \t// margin-left: 1em; => margin-left: calc();\n\n\t// \tfunction ifUnit(value) {\n\t// \t\tvar regex = /^calc\\(|([0-9|.]+px|cm|mm|in|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)$/\n\t// \t\treturn regex.test(value)\n\t// \t}\n\n\t// \tconst origContainer = obj.rules.orig;\n\t// \tconst container = obj.rules.container\n\n\t// \tif ((opts.tailwindCSS && /^.-?m(y-[0-9]|x-[0-9]|-px|-[0-9].?[0-9]?)/gmi.test(obj.rules.orig?.selector))) {\n\n\t// \t\trule.walkDecls((decl) => {\n\n\t// \t\t\tif (ifUnit(decl.value)) {\n\n\n\t// \t\t\t\torigContainer.after(container);\n\n\t// \t\t\t\tif (decl.prop === \"margin\") {\n\t// \t\t\t\t\tcontainer.append(\n\t// \t\t\t\t\t\t`margin: calc(var(${pf}gap-row) + ${obj.marginValues[0]}) ${obj.marginValues[1]} calc(var(${pf}gap-column) + ${obj.marginValues[0]})`\n\t// \t\t\t\t\t)\n\t// \t\t\t\t}\n\n\t// \t\t\t\tif (decl.prop === \"margin-top\") {\n\t// \t\t\t\t\tcontainer.append(\n\t// \t\t\t\t\t\t`margin-top: calc(var(${pf}gap-row) + ${obj.marginValues[0]})`\n\t// \t\t\t\t\t)\n\t// \t\t\t\t}\n\n\t// \t\t\t\tif (decl.prop === \"margin-left\") {\n\t// \t\t\t\t\tcontainer.append(\n\t// \t\t\t\t\t\t`margin-left: calc(var(${pf}gap-column) + ${obj.marginValues[1]})`\n\t// \t\t\t\t\t)\n\t// \t\t\t\t}\n\n\t// \t\t\t\t// let axis = prop === \"width\" ? \"column\" : \"row\";\n\n\t// \t\t\t\tcontainer.walk(i => { i.raws.before = \"\\n\\t\"; });\n\t// \t\t\t}\n\t// \t\t})\n\t// \t}\n\t// }\n\n\t// function removeGap(rule) {\n\t// \trule.walkDecls((decl) => {\n\t// \t\tif (decl.prop === \"gap\" || decl.prop === \"column-gap\" || decl.prop === \"row-gap\") {\n\t// \t\t\t// FIXME: Prevent gap from being deletec in certain scenarios // Thing this is working?\n\t// \t\t\tif (!(opts.flexGapNotSupported || (opts.tailwindCSS && /^.gap(?=\\b|[0-9])/gmi.test(rule.selector)))) {\n\t// \t\t\t\tdecl.remove()\n\t// \t\t\t}\n\t// \t\t}\n\t// \t})\n\t// }\n\n\treturn {\n\t\tpostcssPlugin: 'postcss-gap',\n\t\tOnce(root) {\n\n\t\t\taddRootSelector(root)\n\n\t\t\troot.walkRules(rule => {\n\n\t\t\t\t// To check if rule original or added by plugin\n\t\t\t\tvar origRule = true;\n\t\t\t\trule.walkDecls(decl => {\n\t\t\t\t\tif (decl.prop.startsWith(\"--fgp\") || decl.prop.startsWith(\"--has\")) {\n\t\t\t\t\t\torigRule = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\trule.walkComments(comment => {\n\t\t\t\t\tif (comment.text === \"added by fgp\") {\n\t\t\t\t\t\torigRule = false;\n\t\t\t\t\t}\n\t\t\t\t})\n\n\t\t\t\tvar hasFgp = false;\n\n\t\t\t\tif (Array.isArray(opts.only) || opts.only === true) {\n\t\t\t\t\thasFgp = false\n\t\t\t\t}\n\n\t\t\t\tif (origRule) {\n\t\t\t\t\tvar obj = {\n\t\t\t\t\t\trules: {},\n\t\t\t\t\t\tgapValues: [null, null],\n\t\t\t\t\t\tmarginValues: [null, null, null, null],\n\t\t\t\t\t\thasGap: false,\n\t\t\t\t\t\thasFlex: false,\n\t\t\t\t\t\thasMargin: false,\n\t\t\t\t\t\thasFgp: hasFgp\n\t\t\t\t\t}\n\n\t\t\t\t\trule.walkDecls((decl) => {\n\t\t\t\t\t\tgetRules(decl, obj, root)\n\t\t\t\t\t\tgetFlex(decl, obj);\n\t\t\t\t\t\tgetGap(decl, obj)\n\t\t\t\t\t\tgetMargin(decl, obj)\n\t\t\t\t\t\tgetWidth(decl, obj)\n\t\t\t\t\t});\n\n\t\t\t\t\tif (Array.isArray(opts.only) || opts.only === true) {\n\t\t\t\t\t\tif (obj.hasFlex && obj.hasGap) {\n\t\t\t\t\t\t\tobj.hasFgp = true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif (obj.hasFlex || obj.hasMargin || obj.hasGap || obj.hasFlex) {\n\t\t\t\t\t\t\tobj.hasFgp = true\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (Array.isArray(opts.only)) {\n\t\t\t\t\t\tif (opts.only.includes(rule.selector) || opts.only.some((item) => {\n\t\t\t\t\t\t\tif (item instanceof RegExp) {\n\t\t\t\t\t\t\t\treturn item.test(rule.selector)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})) {\n\t\t\t\t\t\t\tobj.hasFgp = true\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\trule.walkComments(comment => {\n\t\t\t\t\t\tif (comment.text === \"apply fgp\") {\n\t\t\t\t\t\t\tcomment.remove()\n\t\t\t\t\t\t\tobj.hasFgp = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\n\t\t\t\t\tif (obj.hasFgp) {\n\t\t\t\t\t\t// addWidth(rule, obj);\n\t\t\t\t\t\trewriteFlex(rule, obj)\n\t\t\t\t\t\t// addMargin(rule, obj)\n\t\t\t\t\t\trewriteMargin(rule, obj)\n\n\t\t\t\t\t// if ((obj.hasGap && obj.hasFlex) || (opts.tailwindCSS && /^.gap(?=\\b|[0-9])/gmi.test(rule.selector) && !obj.hasFlex)) {\n\t\t\t\t\t// \t// addFlex(rule, obj);\n\t\t\t\t\t// \t// addGap(rule, obj, opts);\n\t\t\t\t\t// \t// removeGap(rule);\n\t\t\t\t\t// }\n\n\n\n\t\t\t\t\t\tif (!(obj.hasMargin && !obj.hasFlex && !obj.hasGap)) {\n\t\t\t\t\t\t\tobj.rules.orig.before(obj.rules.container);\n\n\t\t\t\t\t\t\tobj.rules.container.before(obj.rules.item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (obj.hasFlex) {\n\t\t\t\t\t\t\tobj.rules.item.before(obj.rules.reset);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (obj.hasMargin && !obj.hasFlex && !obj.hasGap) {\n\t\t\t\t\t\t\tobj.rules.orig.before(obj.rules.item);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Clean\n\t\t\t\t\t\tobj.rules.orig.walk(i => {\n\t\t\t\t\t\t\treturn i.raws.before = \"\\n\\t\"\n\t\t\t\t\t\t});\n\t\t\t\t\t\tobj.rules.container.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\t\t\t\t\tobj.rules.item.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\t\t\t\t\tobj.rules.reset.walk(i => { i.raws.before = \"\\n\\t\" });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n}\n\nmodule.exports.postcss = true\n"],"names":["module","exports","opts","pf","flexGapNotSupported","getFlex","decl","obj","prop","value","hasFlex","getWidth","hasWidth","hasHeight","getGap","hasGap","gapValues","postcss","list","space","length","push","getMargin","hasMargin","marginValues","getRules","root","fileName","source","input","file","rules","orig","parent","selector","cssModule","cssModuleEnd","endsWith","container","item","reset","webComponents","rule","prepend","comment","text","addRootSelector","rootRule","append","walk","i","raws","before","rewriteFlex","walkDecls","rewriteMargin","properties","forEach","property","index","axis","side","gapNumber","marginNumber","parse","nodes","unit","unitlessPercentage","postcssPlugin","Once","walkRules","origRule","startsWith","walkComments","hasFgp","Array","isArray","only","includes","some","RegExp","test","remove"],"mappings":"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"}